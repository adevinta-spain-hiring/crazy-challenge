<html>
<head>
    <title>Adevinta Spain Crazy Challenge</title>
</head>
<body>
<div style="width: 100%; height: 100%; text-align: center">
    <p id="crazy-text" style="color: white; font-family: 'Roboto Light'; font-size: 6vw;"></p>
    <img src="adevinta-spain.png" style="width: 25%;">
</div>
<script>
    const crazyTimeoutSeconds = 20
    let crazyStartedOn = new Date()

    crazyElapsedSeconds = function () {
        return (new Date().getTime() - crazyStartedOn.getTime()) / 1000
    }

    changeCrazyText = function (text) {
        document.getElementById('crazy-text').innerHTML = text
    }

    changeBackgroundColor = function (color) {
        document.body.style.backgroundColor = color
    }

    let currentCrazyState = null
    changeCrazyState = function (id) {
        currentCrazyState = crazyStates.find(state => state.id === id)
        currentCrazyState.onEntry()
    }

    const crazyStates = [
        {
            id: 'init',
            onEntry: function () {
                changeCrazyText('Ready?')
                changeBackgroundColor('#292929')
            },
            onKey: function (key) {
                if (key === 't') {
                    changeCrazyState('T')
                } else {
                    changeCrazyState('error')
                }
            },
            onTimeout: function () {
                changeCrazyState('timeout')
            }
        },
        {
            id: 'error',
            onEntry: function () {
                changeCrazyText('Wrong key! Please try again!')
                changeBackgroundColor('#FF0000')
            },
            onKey: function (key) {
                if (key === 't') {
                    changeCrazyState('T')
                } else {
                    changeCrazyState('error')
                }
            },
            onTimeout: function () {
                changeCrazyState('timeout')
            }
        },
        {
            id: 'timeout',
            onEntry: function () {
                changeCrazyText('Timeout! Please, try again!')
                changeBackgroundColor('#FF0000')
            },
            onKey: function (key) {
                if (key === 't') {
                    changeCrazyState('T')
                } else {
                    changeCrazyState('error')
                }
            },
            onTimeout: function () {
            }
        },
        {
            id: 'T',
            onEntry: function () {
                changeCrazyText('Together ...')
                changeBackgroundColor('#D2CB00')
            },
            onKey: function (key) {
                if (key === 'c') {
                    changeCrazyState('TC')
                } else {
                    changeCrazyState('error')
                }
            },
            onTimeout: function () {
                changeCrazyState('timeout')
            }
        },
        {
            id: 'TC',
            onEntry: function () {
                changeCrazyText('Together Creating ...')
                changeBackgroundColor('#00D2CB')
            },
            onKey: function (key) {
                if (key === 'c') {
                    changeCrazyState('TCC')
                } else {
                    changeCrazyState('error')
                }
            },
            onTimeout: function () {
                changeCrazyState('timeout')
            }
        },
        {
            id: 'TCC',
            onEntry: function () {
                changeCrazyText('Together Creating Craziness ðŸ¤ª')
                changeBackgroundColor('#2900D2')
            },
            onKey: function (key) {
            },
            onTimeout: function () {
            }
        }
    ]

    changeCrazyState('init')

    window.setInterval(function () {
        if (crazyElapsedSeconds() > crazyTimeoutSeconds) {
            crazyStartedOn = new Date()
            currentCrazyState.onTimeout()
        }
    }, 500)

    window.addEventListener('keydown', event => {
        currentCrazyState.onKey(event.key.toLowerCase())
    })
</script>
</body>
</html>
